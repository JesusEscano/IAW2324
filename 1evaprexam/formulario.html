<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>
    <style>
        #asum, #dnim, #nombrem, #ape1m, #fecham, #tlfnm, #direccionm, #CPm, #munim, #oficinam, #infom, #anex1m, #anex2m, #polim {color: red}
    </style>
</head>
<body>
    <p><label for="asunto">Asunto*: <input type="number" id="asunto"></label><label id="asum"></label></p>
    <p><label for="dni">DNI/NIE*: <input type="text" id="dni"></label><label id="dnim"></label></p>
    <p><label for="nombre">Nombre*: <input type="text" id="nombre"></label><label id="nombrem"></label></p>
    <p><label for="apellido1">Primer Apellido*: <input type="text" id="apellido"></label><label id="ape1m"></label></p>
    <p><label for="apellido2">Segundo Apellido: <input type="text" id="apellido2"></label></p>
    <p><label for="fecha">Fecha de nacimiento: (dd/mm/aaaa)*: <input type="date" id="fecha"></label><label id="fecham"></label></p>
    <p><label for="telefon">Teléfono de contacto*: <input type="text" id="tlfn"></label><label id="tlfnm"></label></p>
    <p><label for="mail">Correo Electrónico (para respuesta): <input type="email" id="mail"></label></p>
    <p><label for="domicilio">Domicílio*: <input type="text" id="direccion"></label><label id="direccionm"></label></p>
    <p><label for="CP">Código Postal*: <input type="text" id="CP"></label><label id="CPm"></label></p>
    <p><label for="muni"><select required name="provincia" class="form-control" id="provincia">
        <option value="">Provincia*: </option>
        <option value="Álava/Araba">Álava/Araba</option>
        <option value="Albacete">Albacete</option>
        <option value="Alicante">Alicante</option>
        <option value="Almería">Almería</option>
        <option value="Asturias">Asturias</option>
        <option value="Ávila">Ávila</option>
        <option value="Badajoz">Badajoz</option>
        <option value="Baleares">Baleares</option>
        <option value="Barcelona">Barcelona</option>
        <option value="Burgos">Burgos</option>
        <option value="Cáceres">Cáceres</option>
        <option value="Cádiz">Cádiz</option>
        <option value="Cantabria">Cantabria</option>
        <option value="Castellón">Castellón</option>
        <option value="Ceuta">Ceuta</option>
        <option value="Ciudad Real">Ciudad Real</option>
        <option value="Córdoba">Córdoba</option>
        <option value="Cuenca">Cuenca</option>
        <option value="Gerona/Girona">Gerona/Girona</option>
        <option value="Granada">Granada</option>
        <option value="Guadalajara">Guadalajara</option>
        <option value="Guipúzcoa/Gipuzkoa">Guipúzcoa/Gipuzkoa</option>
        <option value="Huelva">Huelva</option>
        <option value="Huesca">Huesca</option>
        <option value="Jaén">Jaén</option>
        <option value="La Coruña/A Coruña">La Coruña/A Coruña</option>
        <option value="La Rioja">La Rioja</option>
        <option value="Las Palmas">Las Palmas</option>
        <option value="León">León</option>
        <option value="Lérida/Lleida">Lérida/Lleida</option>
        <option value="Lugo">Lugo</option>
        <option value="Madrid">Madrid</option>
        <option value="Málaga">Málaga</option>
        <option value="Melilla">Melilla</option>
        <option value="Murcia">Murcia</option>
        <option value="Navarra">Navarra</option>
        <option value="Orense/Ourense">Orense/Ourense</option>
        <option value="Palencia">Palencia</option>
        <option value="Pontevedra">Pontevedra</option>
        <option value="Salamanca">Salamanca</option>
        <option value="Segovia">Segovia</option>
        <option value="Sevilla">Sevilla</option>
        <option value="Soria">Soria</option>
        <option value="Tarragona">Tarragona</option>
        <option value="Tenerife">Tenerife</option>
        <option value="Teruel">Teruel</option>
        <option value="Toledo">Toledo</option>
        <option value="Valencia">Valencia</option>
        <option value="Valladolid">Valladolid</option>
        <option value="Vizcaya/Bizkaia">Vizcaya/Bizkaia</option>
        <option value="Zamora">Zamora</option>
        <option value="Zaragoza">Zaragoza</option>
      </select></label><label id="munim"></label></p>
      <p><label for="ofi"><select required name="oficina" class="form-control" id="oficina">
        <option value="">Oficina*: </option>
        <option value="1">Oficina 1</option>
        <option value="2">Oficina 2</option>
        <option value="3">Oficina 3</option>
        <option value="4">Oficina 4</option>
      </select></label><label id="oficinam"></label></p>
      <p><label for="info">Información requerida*: <textarea id="info" name="info" rows="5" cols="50"></textarea></label><label id="infom"></label></p>
      <p><label for="anex1">Fichero Anexo I (máximo 2MB): <input type="file" id="anex1"></label><label id="anex1m"></label></p>
      <p><label for="anex2">Fichero Anexo II (máximo 2MB): <input type="file" id="anex2"></label><label id="anex2m"></label></p>
<br>
<br>
<br>
<p>He leído y aceptado la <a href="https://europa.eu/youreurope/business/dealing-with-customers/data-protection/data-protection-gdpr/index_es.htm">política de datos y normas de uso</a>
    <input type="checkbox" id="poli" /><label id="polim"></label></p>
    <button onclick="comp()">Enviar</button>
    <p id="resultado"></p>
<script>
    var resultado = '';
    function comp(){
        let asunto = (document.getElementById('asunto').value);
        let dni = (document.getElementById('dni').value);
        let numero=8;
        let contador=parseInt(dni.length);
        let opciones="TRWAGMYFPDXBNJZSQVHLCKET";
        let dnicom=/^[0-9]+$/ 
        let Com=dni%23;
        let FIN=opciones.substring(Com,Com+1);
        let nombre = (document.getElementById('nombre').value);
        let apellido = (document.getElementById('apellido').value);
        let fecha = (document.getElementById('fecha').value);
        let telefon = (document.getElementById('tlfn').value);
        let telefval = new RegExp("^(\\+34|0034|34)?[6789]\\d{8}$");
        let direccion = (document.getElementById('direccion').value);
        let CP = (document.getElementById('CP').value);
        let provincia = (document.getElementById('provincia').value);
        let oficina = (document.getElementById('oficina').value);
        let info = (document.getElementById('info').value);
        const MAXIMO_TAMANIO_BYTES = 2000000; // 2MB = 2 millones de bytes
        let $anex1 = document.getElementById('anex1');
        let $anex2 = document.getElementById('anex2');
        let politica = (document.getElementById('poli').checked);

        document.getElementById('asum').innerHTML='';
        document.getElementById('dnim').innerHTML='';
        document.getElementById('nombrem').innerHTML='';
        document.getElementById('ape1m').innerHTML='';
        document.getElementById('fecham').innerHTML='';
        document.getElementById('tlfnm').innerHTML='';
        document.getElementById('direccionm').innerHTML='';
        document.getElementById('CPm').innerHTML='';
        document.getElementById('munim').innerHTML='';
        document.getElementById('oficinam').innerHTML='';
        document.getElementById('infom').innerHTML='';
        document.getElementById('anex1m').innerHTML='';
        document.getElementById('anex2m').innerHTML='';
        document.getElementById('polim').innerHTML='';

        if (asunto.trim() === ''){document.getElementById("asum").innerHTML = " El campo Asunto es necesario para completar el formulario";}
        if (dni.trim() === ''){document.getElementById("dnim").innerHTML = " El campo DNI es necesario para completar el formulario";}
        else if (contador!=numero || !dni.match(dnicom)){document.getElementById("dnim").innerHTML = " El DNI es erróneo";}
        if (nombre.trim() === ''){document.getElementById("nombrem").innerHTML = " El campo Nombre es necesario para completar el formulario";}
        if (apellido.trim() === ''){document.getElementById("ape1m").innerHTML = " El campo Primer Apellido es necesario para completar el formulario";}
        if (fecha.trim() === ''){document.getElementById("fecham").innerHTML = " El campo Fecha de Nacimiento es necesario para completar el formulario";}
        if (telefon.trim() === ''){document.getElementById("tlfnm").innerHTML = " El campo Teléfono es necesario para completar el formulario";}
        else if (!telefval.test(telefon)){document.getElementById("tlfnm").innerHTML = " Su número de teléfono es erróneo";}
        if (direccion.trim() === ''){document.getElementById("direccionm").innerHTML = " El campo Domicilio es necesario para completar el formulario";}
        if (CP.trim() === ''){document.getElementById("CPm").innerHTML = " El campo Código Postal es necesario para completar el formulario";}
        if (provincia.trim() === ''){document.getElementById("munim").innerHTML = " El campo Provincia es necesario para completar el formulario";}
        if (oficina.trim() === ''){document.getElementById("oficinam").innerHTML = " El campo Oficina es necesario para completar el formulario";}
        if (info.trim() === ''){document.getElementById("infom").innerHTML = " El campo 'Información requerida' es necesario para completar el formulario";}
$anex1.addEventListener("change", function () {
    // si no hay archivos, regresamos
    if (this.files.length <= 0) return;
    // Validamos el primer archivo únicamente
    const archivo = this.files[0];
    if (archivo.size > MAXIMO_TAMANIO_BYTES) {
        const tamanioEnMb = MAXIMO_TAMANIO_BYTES / 1000000;
        document.getElementById("anex1m").innerHTML = ` El tamaño máximo es ${tamanioEnMb} MB`;
        // Limpiar
        $anex1.value = "";
        console.log(archivo.size);
    }
});
$anex2.addEventListener("change", function () {
    // si no hay archivos, regresamos
    if (this.files.length <= 0) return;
    // Validamos el primer archivo únicamente
    const archivo = this.files[0];
    if (archivo.size > MAXIMO_TAMANIO_BYTES) {
        const tamanioEnMb = MAXIMO_TAMANIO_BYTES / 1000000;
        document.getElementById("anex2m").innerHTML = ` El tamaño máximo es ${tamanioEnMb} MB`;
        // Limpiar
        $anex2.value = "";
        console.log(archivo.size);
    }
});
        if (!politica){document.getElementById("polim").innerHTML = "Debe aceptar las políticas";}
        //if (nombre.trim() != '' && apellido.trim() != '' && mail.trim() != '' && mailval.test(mail) && telefon.trim() != '' && telefval.test(telefon) && contador===numero && dni.match(dnicom) && PIN.length===numero && PIN2===PIN) {resultado = "Registrado. Su nombre de usuario es "+nombre.substr(0,2)+apellido.substr(0,2)+telefon.slice(-3);}
        document.getElementById('resultado').innerHTML = resultado;

        //He tardado hora y media, mucho que escribir
     }
</script>

</body>
</html>
